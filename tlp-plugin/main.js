/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var d=Object.defineProperty;var g=Object.getOwnPropertyDescriptor;var u=Object.getOwnPropertyNames;var v=Object.prototype.hasOwnProperty;var m=(r,s)=>{for(var a in s)d(r,a,{get:s[a],enumerable:!0})},f=(r,s,a,t)=>{if(s&&typeof s=="object"||typeof s=="function")for(let e of u(s))!v.call(r,e)&&e!==a&&d(r,e,{get:()=>s[e],enumerable:!(t=g(s,e))||t.enumerable});return r};var T=r=>f(d({},"__esModule",{value:!0}),r);var L={};m(L,{default:()=>p});module.exports=T(L);var l=require("obsidian"),w={levels:[{level:"red",name:"TLP:RED",color:"#ff2a2a"},{level:"amber",name:"TLP:AMBER",color:"#ffbf00"},{level:"amber+strict",name:"TLP:AMBER+STRICT",color:"#ffbf00"},{level:"yellow",name:"TLP:YELLOW",color:"#ffbf00"},{level:"green",name:"TLP:GREEN",color:"#2aff2a"},{level:"white",name:"TLP:WHITE",color:"#ffffff"},{level:"clear",name:"TLP:CLEAR",color:"#ffffff"}]},p=class extends l.Plugin{async onload(){await this.loadSettings(),this.initializeTlpIndicators(),this.initializeTlpBanner(),this.addStatusBarItem().setText("Status Bar Text"),this.addCommand({id:"open-sample-modal-simple",name:"Open sample modal (simple)",callback:()=>{new c(this.app).open()}}),this.addCommand({id:"sample-editor-command",name:"Sample editor command",editorCallback:(t,e)=>{console.log(t.getSelection()),t.replaceSelection("Sample Editor Command")}}),this.addCommand({id:"open-sample-modal-complex",name:"Open sample modal (complex)",checkCallback:t=>{if(this.app.workspace.getActiveViewOfType(l.MarkdownView))return t||new c(this.app).open(),!0}}),this.addSettingTab(new h(this.app,this)),this.registerDomEvent(document,"click",t=>{console.log("click",t)}),this.registerInterval(window.setInterval(()=>console.log("setInterval"),5*60*1e3))}onunload(){}async loadSettings(){this.settings=Object.assign({},w,await this.loadData())}async saveSettings(){await this.saveData(this.settings)}getLevelConfig(a){return this.settings.levels.find(t=>t.level.toLowerCase()===a.toLowerCase())}getRawTlp(a){var n;let t=this.app.metadataCache.getFileCache(a),e=t==null?void 0:t.frontmatter,i=(n=e==null?void 0:e.tlp)!=null?n:e==null?void 0:e.TLP;return i!=null?i:null}getTlpColor(a){var n;let t=this.app.metadataCache.getFileCache(a),e=t==null?void 0:t.frontmatter,i=(n=e==null?void 0:e.tlp)!=null?n:e==null?void 0:e.TLP;if(i){let o=this.getLevelConfig(i);if(o)return o.color}return null}updateFileIndicator(a){document.querySelectorAll(".nav-file-title-content").forEach(e=>{if(e.getAttribute("data-path")===a.path){let i=e.querySelector(".tlp-indicator");i||(i=document.createElement("span"),i.classList.add("tlp-indicator"),e.prepend(i));let n=this.getTlpColor(a);n?(i.style.backgroundColor=n,i.style.display="inline-block"):i.style.display="none"}})}updateAllFileIndicators(){this.app.vault.getMarkdownFiles().forEach(a=>this.updateFileIndicator(a))}initializeTlpIndicators(){this.app.workspace.onLayoutReady(()=>this.updateAllFileIndicators()),this.registerEvent(this.app.metadataCache.on("changed",a=>{a instanceof l.TFile&&this.updateFileIndicator(a)})),this.registerEvent(this.app.vault.on("rename",a=>{a instanceof l.TFile&&this.updateFileIndicator(a)}))}getTlpLevelName(a){var o;let t=this.app.metadataCache.getFileCache(a),e=t==null?void 0:t.frontmatter,i=(o=e==null?void 0:e.tlp)!=null?o:e==null?void 0:e.TLP;if(!i)return null;let n=this.getLevelConfig(i);return n?n.name:i.toUpperCase()}updateBanner(a){let t=this.app.workspace.getActiveViewOfType(l.MarkdownView);if(!t)return;let e=t.contentEl.querySelector(".tlp-banner");if(e||(e=document.createElement("div"),e.classList.add("tlp-banner"),t.contentEl.prepend(e)),!a){e.style.display="none",e.classList.remove("show");return}let i=this.getTlpColor(a),n=this.getTlpLevelName(a),o=this.getRawTlp(a);i&&n&&o?(e.textContent=n,e.setAttribute("data-tlp",o),e.style.backgroundColor=i,e.style.display="block",e.classList.remove("show"),e.offsetWidth,e.classList.add("show")):(e.style.display="none",e.classList.remove("show"))}initializeTlpBanner(){this.app.workspace.onLayoutReady(()=>{this.updateBanner(this.app.workspace.getActiveFile())}),this.registerEvent(this.app.workspace.on("file-open",a=>this.updateBanner(a))),this.registerEvent(this.app.metadataCache.on("changed",a=>{let t=this.app.workspace.getActiveFile();t&&a.path===t.path&&this.updateBanner(a)}))}},c=class extends l.Modal{constructor(s){super(s)}onOpen(){let{contentEl:s}=this;s.setText("Woah!")}onClose(){let{contentEl:s}=this;s.empty()}},h=class extends l.PluginSettingTab{constructor(a,t){super(a,t);this.plugin=t}display(){let{containerEl:a}=this;a.empty(),a.createEl("h2",{text:"TLP Levels"}),this.plugin.settings.levels.forEach((t,e)=>{let i=new l.Setting(a);i.addText(n=>n.setPlaceholder("Level").setValue(t.level).onChange(async o=>{t.level=o,await this.plugin.saveSettings(),this.plugin.updateAllFileIndicators(),this.plugin.updateBanner(this.app.workspace.getActiveFile())})),i.addText(n=>n.setPlaceholder("Display Name").setValue(t.name).onChange(async o=>{t.name=o,await this.plugin.saveSettings(),this.plugin.updateBanner(this.app.workspace.getActiveFile())})),i.addColorPicker(n=>n.setValue(t.color).onChange(async o=>{t.color=o,await this.plugin.saveSettings(),this.plugin.updateAllFileIndicators(),this.plugin.updateBanner(this.app.workspace.getActiveFile())})),i.addExtraButton(n=>n.setIcon("cross").setTooltip("Delete").onClick(async()=>{this.plugin.settings.levels.splice(e,1),await this.plugin.saveSettings(),this.display(),this.plugin.updateAllFileIndicators(),this.plugin.updateBanner(this.app.workspace.getActiveFile())}))}),new l.Setting(a).addButton(t=>t.setButtonText("Add Level").onClick(()=>{this.plugin.settings.levels.push({level:"",name:"",color:"#ffffff"}),this.display()}))}};
